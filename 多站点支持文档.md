# TEMU小助手 - 多站点支持文档

## 支持的站点

现在TEMU小助手支持以下4个站点：

### 1. 🌍 全球站（除美国、欧洲）
- **URL**: https://agentseller.temu.com/
- **适用区域**: 除美国和欧洲外的所有地区
- **站点标识**: 全球站(除美国、欧洲)

### 2. 🇺🇸 美国站
- **URL**: https://agentseller-us.temu.com/
- **适用区域**: 美国地区
- **站点标识**: 美国站

### 3. 🇪🇺 欧洲站
- **URL**: https://agentseller-eu.temu.com/
- **适用区域**: 欧洲地区
- **站点标识**: 欧洲站

### 4. 🏢 商家中心
- **URL**: https://seller.kuajingmaihuo.com/main
- **特点**: 使用主站Cookie，无需单独获取
- **站点标识**: 商家中心

## 技术实现

### 站点配置结构
```javascript
const SITE_CONFIG = {
    GLOBAL: {
        url: 'https://agentseller.temu.com/',
        name: '全球站(除美国、欧洲)',
        domains: ['agentseller.temu.com', '.agentseller.temu.com']
    },
    US: {
        url: 'https://agentseller-us.temu.com/',
        name: '美国站',
        domains: ['agentseller-us.temu.com', '.agentseller-us.temu.com']
    },
    EU: {
        url: 'https://agentseller-eu.temu.com/',
        name: '欧洲站',
        domains: ['agentseller-eu.temu.com', '.agentseller-eu.temu.com']
    },
    SELLER_CENTER: {
        url: 'https://seller.kuajingmaihuo.com/main',
        name: '商家中心',
        domains: ['seller.kuajingmaihuo.com', '.seller.kuajingmaihuo.com']
    }
};
```

### 核心功能

1. **站点识别函数** `isTargetSite(url)`
   - 判断URL是否为支持的站点
   - 支持所有TEMU站点和商家中心

2. **站点名称获取** `getSiteName(url)`
   - 根据URL返回站点友好名称
   - 用于控制台输出和UI显示

3. **域名管理** `getAllTemuDomains()`
   - 获取所有TEMU相关域名
   - 用于Cookie获取和清除

## 登录流程

### 步骤1：登录主站
1. 打开应用，显示欢迎页面
2. 点击"立即登录"
3. 登录跨境卖货平台账号
4. 系统获取并保存主站Cookie

### 步骤2：选择站点
登录成功后，会显示站点选择页面，用户可以选择：
- 全球站（除美国、欧洲）
- 美国站
- 欧洲站
- 商家中心

### 步骤3：获取站点Cookie
- **TEMU站点**：跳转到对应站点，自动获取该站点的Cookie
- **商家中心**：直接使用主站Cookie，无需额外获取

### 步骤4：返回主界面
Cookie获取成功后，自动返回主应用界面，显示：
- 店铺信息
- 当前站点名称
- Cookie统计信息

## Cookie管理

### Cookie存储
- **主站Cookie**: `global.platformCookies`
- **分站Cookie**: `global.temuCookies`

### Cookie清除
退出登录时会清除所有站点的Cookie：
- kuajingmaihuo.com
- agentseller.temu.com
- agentseller-us.temu.com
- agentseller-eu.temu.com
- seller.kuajingmaihuo.com

## 测试用例

### 测试1：全球站登录
1. 启动应用
2. 登录主站账号
3. 选择"全球站"
4. 验证控制台输出：`当前站点: 全球站(除美国、欧洲)`
5. 验证Cookie获取成功

### 测试2：美国站登录
1. 启动应用
2. 登录主站账号
3. 选择"美国站"
4. 验证控制台输出：`当前站点: 美国站`
5. 验证Cookie获取成功

### 测试3：欧洲站登录
1. 启动应用
2. 登录主站账号
3. 选择"欧洲站"
4. 验证控制台输出：`当前站点: 欧洲站`
5. 验证Cookie获取成功

### 测试4：商家中心登录
1. 启动应用
2. 登录主站账号
3. 选择"商家中心"
4. 验证控制台输出：`当前站点: 商家中心`
5. 验证使用主站Cookie

### 测试5：站点切换
1. 登录任意站点
2. 在主界面点击"切换站点"
3. 选择另一个站点
4. 验证新站点Cookie获取成功

### 测试6：退出登录
1. 登录任意站点
2. 点击"退出"按钮
3. 验证所有站点Cookie被清除
4. 验证返回欢迎页面

## 控制台输出示例

### 站点识别
```
检测到尝试打开新窗口: https://agentseller-us.temu.com/...
拦截美国站新窗口，在当前窗口加载
检测到跳转至美国站，准备获取Cookie...
```

### Cookie获取
```
开始获取站点Cookie...
当前页面URL: https://agentseller-us.temu.com/...
当前站点: 美国站
从所有Cookie中筛选出 11 个TEMU相关Cookie
```

### 站点信息
```
【分站(TEMU) Cookie信息】
=====================================
Cookie数量: 11个
当前站点: 美国站
=====================================
```

## 注意事项

1. **Cookie独立性**：每个站点的Cookie独立管理，互不影响
2. **商家中心特殊性**：商家中心使用主站Cookie，无需额外获取
3. **自动识别**：系统会自动识别用户选择的站点，无需手动配置
4. **完整清除**：退出登录会清除所有站点的Cookie，确保安全

## 更新日志

- **2025-09-10**: 扩展支持美国站、欧洲站和商家中心
- **2025-09-10**: 优化站点识别逻辑，使用配置化管理
- **2025-09-10**: 完善Cookie获取和清除机制